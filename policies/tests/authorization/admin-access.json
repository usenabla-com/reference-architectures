{
  "description": "Test administrator full access permissions",
  "tests": [
    {
      "name": "Admin can access restricted application",
      "principal": {
        "type": "Nabla::User",
        "id": "admin@nabla.io"
      },
      "action": {
        "type": "Nabla::Action",
        "id": "read"
      },
      "resource": {
        "type": "Nabla::Application",
        "id": "openbao"
      },
      "context": {
        "mfaVerified": true,
        "sessionId": "session-123"
      },
      "entities": [
        {
          "uid": { "type": "Nabla::User", "id": "admin@nabla.io" },
          "attrs": {
            "email": "admin@nabla.io",
            "department": "engineering",
            "clearanceLevel": "restricted",
            "mfaVerified": true,
            "sessionId": "session-123"
          },
          "parents": [
            { "type": "Nabla::Group", "id": "Administrators" }
          ]
        }
      ],
      "expected": "allow"
    },
    {
      "name": "Admin can perform admin action",
      "principal": {
        "type": "Nabla::User",
        "id": "admin@nabla.io"
      },
      "action": {
        "type": "Nabla::Action",
        "id": "admin"
      },
      "resource": {
        "type": "Nabla::Application",
        "id": "nextcloud"
      },
      "context": {
        "mfaVerified": true,
        "sessionId": "session-123"
      },
      "expected": "allow"
    },
    {
      "name": "Admin without MFA denied for restricted resources",
      "principal": {
        "type": "Nabla::User",
        "id": "admin-nomfa@nabla.io"
      },
      "action": {
        "type": "Nabla::Action",
        "id": "read"
      },
      "resource": {
        "type": "Nabla::Application",
        "id": "openbao"
      },
      "context": {
        "mfaVerified": false,
        "sessionId": "session-456"
      },
      "entities": [
        {
          "uid": { "type": "Nabla::User", "id": "admin-nomfa@nabla.io" },
          "attrs": {
            "email": "admin-nomfa@nabla.io",
            "department": "engineering",
            "clearanceLevel": "restricted",
            "mfaVerified": false,
            "sessionId": "session-456"
          },
          "parents": [
            { "type": "Nabla::Group", "id": "Administrators" }
          ]
        }
      ],
      "expected": "deny"
    }
  ]
}
